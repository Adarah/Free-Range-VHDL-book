\chapter{Exercise Solutions}
\stoptocwriting

\setcounter{section}{3}
\section*{Chapter 3}
\begin{enumerate}
	\item A "bundle" refers to a series of signal which are related to each other. It is often referred to as a "bus", but is referred to by a different name to prevent confusion.
	
	\item A bundle is often shown in black box diagrams as a wire with a slash on it and a number above it indicating the number of signals contained in the bundle.
	
	\item It is considered good practice to draw a black-box diagram of components before implementing them in VHDL as this helps provide a visual representation of each component. In addition, it helps eliminate confusion from having many logic gates inside and allows for the reuse of components elsewhere in your code.
	
	\item The given black-box drawings can be represented with the following VHDL code.
	
	\noindent
	\begin{minipage}{1\linewidth}
		a)
		\begin{lstlisting}[]		
ENTITY sys1 IS
	PORT (
		a_in1		:	IN	STD_LOGIC;
		b_in2		:	IN	STD_LOGIC;
		clk			:	IN	STD_LOGIC;
		ctrl_int	:	IN	STD_LOGIC;
		out_b		:	OUT STD_LOGIC);
END sys1;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		b)
		\begin{lstlisting}[]
ENTITY sys2 IS
	PORT (
		input_w	:	IN	STD_LOGIC;
		a_data	:	IN	STD_LOGIC_VECTOR(7 DOWNTO 0);
		b_data	:	IN	STD_LOGIC_VECTOR(7 DOWNTO 0);
		clk		:	IN	STD_LOGIC;
		dat_4	:	OUT	STD_LOGIC_VECTOR(7 DOWNTO 0);
		dat_5	:	OUT	STD_LOGIC_VECTOR(2 DOWNTO 0));
END sys2;
		\end{lstlisting}
	\end{minipage}

	\item The black-box figures are shown below.
	
	\begin{minipage}{1\linewidth}
		\vspace{5pt}
		a)\\
		\begin{tikzpicture}[x=1mm,y=1mm,line width=0.8pt,scale=0.8,framed]
		%\draw[help lines] (0,0) grid (50,50);
		% BOX
		\draw (20,-5) rectangle (37,25) node[midway]{ckt\_c};
		% INPUTS
		\small
		\node (hide) at (0,30) {}; % just to expand background
		\node (a) at (20,-2.5) {}; % this is the reference point
		\draw [latex-] ($(a)+(0,25)$) -- ++(-10,0) node[left]{bun\_a}
		node[pos=0.4,above]{8} node[pos=0.7]{/};
		\draw [latex-] ($(a)+(0,20)$) -- ++(-10,0) node[left]{bun\_b}
		node[pos=0.4,above]{8} node[pos=0.7]{/};
		\draw [latex-] ($(a)+(0,15)$) -- ++(-10,0) node[left]{bun\_c}
		node[pos=0.4,above]{8} node[pos=0.7]{/};
		\draw [latex-] ($(a)+(0,10)$) -- ++(-10,0) node[left]{lda};
		\draw [latex-] ($(a)+(0,5)$) -- ++(-10,0) node[left]{ldb};
		\draw [latex-] ($(a)+(0,0)$) -- ++(-10,0) node[left]{ldc};
		% OUTPUTS
		\draw [-latex] ($(a)+(17,19)$) -- ++(10,0) node[right]{reg\_a} node[pos=0.6,above]{8} node[pos=0.4]{/};
		\draw [-latex] ($(a)+(17,12)$) -- ++(10,0) node[right]{reg\_b} node[pos=0.6,above]{8} node[pos=0.4]{/};
		\draw [-latex] ($(a)+(17,5)$) -- ++(10,0) node[right]{reg\_c} node[pos=0.6,above]{8} node[pos=0.4]{/};
		\end{tikzpicture}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		\vspace{5pt}
		b)\\
		\begin{tikzpicture}[x=1mm,y=1mm,line width=0.8pt,scale=0.8,framed]
		%\draw[help lines] (0,0) grid (50,50);
		% BOX
		\draw (20,-10) rectangle (37,25) node[midway]{ckt\_e};
		% INPUTS
		\small
		\node (hide) at (0,30) {}; % just to expand background
		\node (a) at (20,-2.5) {}; % this is the reference point
		\draw [latex-] ($(a)+(0,25)$) -- ++(-10,0) node[left]{RAM\_CS};
		\draw [latex-] ($(a)+(0,20)$) -- ++(-10,0) node[left]{RAM\_WE};
		\draw [latex-] ($(a)+(0,15)$) -- ++(-10,0) node[left]{RAM\_OE};
		\draw [latex-] ($(a)+(0,10)$) -- ++(-10,0) node[left]{SEL\_OP1}
		node[pos=0.4,above]{4} node[pos=0.7]{/};
		\draw [latex-] ($(a)+(0,5)$) -- ++(-10,0) node[left]{SEL\_OP2}
		node[pos=0.4,above]{4} node[pos=0.7]{/};
		\draw [latex-] ($(a)+(0,0)$) -- ++(-10,0) node[left]{RAM\_DATA\_IN}
		node[pos=0.4,above]{8} node[pos=0.7]{/};
		\draw [latex-] ($(a)+(0,-5)$) -- ++(-10,0) node[left]{RAM\_ADDR\_IN}
		node[pos=0.4,above]{10} node[pos=0.7]{/};
		% OUTPUTS
		\draw [-latex] ($(a)+(17,10)$) -- ++(10,0) node[right]{RAM\_DATA\_OUT} node[pos=0.6,above]{8} node[pos=0.4]{/};
		\end{tikzpicture}
	\end{minipage}

	\item a) Line 4 is missing a semicolon, and the semicolon in line 5 should be outside of the parenthesis. Correction:
	
	\begin{minipage}{1\linewidth}
		\begin{lstlisting}[]
ENTITY ckt_a IS
	PORT (
		J,K	:	IN	STD_LOGIC;
		CLK	:	IN	STD_LOGIC;
		Q	:	OUT	STD_LOGIC);
END ckt_a;
		\end{lstlisting}
	\end{minipage}
		
	b) Line 5 should have double parentheses before the semicolon. \mbox{Correction:}
	
	\begin{minipage}{1\linewidth}
		\begin{lstlisting}[]
ENTITY ckt_b IS
	PORT (
		mr_fluffy	:	IN	STD_LOGIC_VECTOR(15 DOWNTO 0);
		mux_ctrl	:	IN	STD_LOGIC_VECTOR(3 DOWNTO 0);
		byte_out	:	OUT	STD_LOGIC_VECTOR(3 DOWNTO 0));
END ckt_b;
		\end{lstlisting}
	\end{minipage}
	
\end{enumerate}

\section*{Chapter 4}
\begin{enumerate}
	\begin{minipage}{1\linewidth}
	\item a)
		\begin{lstlisting}[]
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_a IS
	PORT (
		A,B	:	IN	STD_LOGIC;
		F	:	OUT	STD_LOGIC);
END ckt_a;

ARCHITECTURE ckt_a_arc OF ckt_a IS
BEGIN
	F <= (NOT A AND B) OR A OR (A AND NOT B);
END ckt_a_arc;
		\end{lstlisting}
	\end{minipage}
	
	\begin{minipage}{1\linewidth}
		
		b)
		\begin{lstlisting}[]
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_b IS
	PORT(
		A,B,C,D	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_b;

ARCHITECTURE ckt_b_arc OF ckt_b IS
BEGIN
	F <= (NOT A AND C AND NOT D) OR (NOT B AND C) OR (B AND C AND NOT D);
END ckt_b_arc;
		\end{lstlisting}
	\end{minipage}
	
	\begin{minipage}{1\linewidth}
		c)
		\begin{lstlisting}[]
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_c IS
	PORT(
		A,B,C,D	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_c;

ARCHITECTURE ckt_c_arc OF ckt_c IS
	SIGNAL AND1,AND2,AND3	:	STD_LOGIC;
BEGIN
	AND1 <= NOT A OR B;
	AND2 <= NOT B OR C OR NOT D;
	AND3 <= NOT A OR D;
	F <= AND1 AND AND2 AND AND3;
END ckt_c_arc;
		\end{lstlisting}
	\end{minipage}
	
	\begin{minipage}{1\linewidth}
		d)
		\begin{lstlisting}[]
LIBRARY IEEE;
USE IEE.STD_LOGIC_1164.ALL;

ENTITY ckt_d IS
	PORT(
		A,B,C,D	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_d;

ARCHITECTURE ckt_d_arc OF ckt_d IS
	SIGNAL AND1,AND2	:	STD_LOGIC;
BEGIN
	AND1 <= A OR B OR NOT C OR NOT D;
	AND2 <= A OR B OR C OR NOT D;
	F <= AND1 AND AND2;
END ckt_d_arc;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		e)
		\begin{lstlisting}[]
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_e IS
	PORT(
		A,B,C	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_e;

ARCHITECTURE ckt_e_arc OF ckt_e IS
	SIGNAL AND1,AND2,AND3,AND4	:	STD_LOGIC;
BEGIN
	AND1 <= NOT C OR B OR NOT A;
	AND2 <= C OR B OR NOT A;
	AND3 <= NOT C OR B OR A;
	AND4 <= C OR NOT B OR NOT A;
	F <= AND1 AND AND2 AND AND3 AND AND4;
END ckt_e_arc;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		f)
		\begin{lstlisting}[]
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_f IS
	PORT(
		A,B,C,D	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_f;

ARCHITECTURE ckt_f_arc OF ckt_f IS
	SIGNAL OR1,OR2	:	STD_LOGIC;
BEGIN
	OR1 <= NOT A AND NOT B AND NOT C AND D;
	OR2 <= NOT A AND NOT B AND C AND NOT D;
	F <= OR1 OR OR2;
END ckt_f_arc;
		\end{lstlisting}
	\end{minipage}
	
	\begin{minipage}{1\linewidth}
	\item a)
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_a IS
	PORT(
		A,B,C,D	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_a;

ARCHITECTURE ckt_a_conditional OF ckt_a IS
BEGIN
	F <=
		'1' WHEN( A = '0' AND C = '1' AND D = '0' ) ELSE
		'1' WHEN( B = '0' AND C = '1') ELSE
		'1' WHEN( B = '1' AND C = '1' AND D = '0' ) ELSE
		'0';
END ckt_a_conditional;

ARCHITECTURE ckt_a_selected OF ckt_a IS
	SIGNAL ins	:	STD_LOGIC_VECTOR(0 TO 3);
BEGIN
	ins <= A & B & C & D;
	WITH ins SELECT
		F <=
			'1' WHEN "0010"|"0110",
			'1' WHEN "0010"|"0011"|"1010"|"1011",
			'1' WHEN "0110"|"1110",
			'0' WHEN OTHERS;			
END ckt_a_selected;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		b)
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_b IS
	PORT(
		A,B,C,D	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_b;

ARCHITECTURE ckt_b_conditional OF ckt_b IS
BEGIN
	F <=
		'1' WHEN( ( A = '0' OR B = '1') AND ( B = '1' OR C = '1' OR D = '0' ) AND ( A = '0' OR D = '1') ) ELSE
		'0';
END ckt_b_conditional;

ARCHITECTURE ckt_b_selected OF ckt_b IS
	SIGNAL ins	:	STD_LOGIC_VECTOR(0 TO 3);
BEGIN
	ins <= A & B & C & D;
	WITH ins SELECT
		F <=
		'1' WHEN "0000"|"0001"|"0010"|"0011"|"0100",
		'1' WHEN "0110"|"0111",
		'1' WHEN "1111",
		'0' WHEN OTHERS;
END ckt_b_selected;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		c)
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_c IS
	PORT(
		A,B,C,D	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_c;

ARCHITECTURE ckt_c_conditional OF ckt_c IS
BEGIN
	F <=
		'1' WHEN( ( A = '1' OR B = '0' OR C = '0' OR D = '0') AND ( A = '1' OR B = '1' OR C = '1' OR D = '0' ) ) ELSE
		'0';
END ckt_c_conditional;

ARCHITECTURE ckt_c_selected OF ckt_c IS
	SIGNAL ins	:	STD_LOGIC_VECTOR(0 TO 3);
BEGIN
	ins <= A & B & C & D;
	WITH ins SELECT
		F <=
			'0' WHEN "0001"|"0011",
			'1' WHEN OTHERS;
END ckt_c_selected;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		d)
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY ckt_d IS
	PORT(
		A,B,C,D	:	IN	STD_LOGIC;
		F		:	OUT	STD_LOGIC);
END ckt_d;

ARCHITECTURE ckt_d_conditional OF ckt_d IS
BEGIN
	F <=
		'1' WHEN( ( A = '0' AND B = '0' AND C = '0' AND D = '1') OR ( A = '0' AND B = '0' AND C = '1' AND D = '0' ) ) ELSE
		'0';
END ckt_d_conditional;

ARCHITECTURE ckt_d_selected OF ckt_d IS
	SIGNAL ins	:	STD_LOGIC_VECTOR(0 TO 3);
BEGIN
	ins <= A & B & C & D;
	WITH ins SELECT
		F <=
			'1' WHEN "0001"|"0010",
			'0' WHEN OTHERS;
END ckt_d_selected;
		\end{lstlisting}
	\end{minipage}
	
	\begin{minipage}{1\linewidth}
		\item
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY and8 IS
	PORT(
		in0,in1,in2,in3,in4,in5,in6,in7	:	IN	STD_LOGIC;
		out1							:	OUT	STD_LOGIC);
END and8;

ARCHITECTURE and8_concurrent OF and8 IS
BEGIN
	out1 <= in0 AND in1 AND in2 AND in3 AND in4 AND in5 AND in6 AND in7;
END and8_concurrent;

ARCHITECTURE and8_conditional OF and8 IS
BEGIN
	out1 <= '1' WHEN (in0 = '1' AND in1 = '1' AND in2 = '1' AND in3 = '1' AND in4 = '1' AND in5 = '1' AND in6 = '1' AND in7 = '1') ELSE
	'0';
END and8_conditional;

ARCHITECTURE and8_selected OF and8 IS
	SIGNAL ins	:	STD_LOGIC_VECTOR(0 TO 7);
BEGIN
	ins <= in0 & in1 & in2 & in3 & in4 & in5 & in6 & in7;
	WITH ins SELECT
		out1 <=
			'1' WHEN "11111111",
			'0' WHEN OTHERS;
END and8_selected;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		\item
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE_STD_LOGIC_1164.ALL;

ENTITY or8 IS
	PORT(
		ins		:	IN	STD_LOGIC_VECTOR(7 DOWNTO 0);
		out1	:	OUT	STD_LOGIC);
END or8;

ARCHITECTURE or8_concurrent OF or8 IS
BEGIN
	out1 <= ins(1) OR ins(2) OR ins(3) OR ins(4) OR ins(5) OR ins(6) OR ins(7);
END or8_concurrent;

ARCHITECTURE or8_conditional OF or8 IS
BEGIN
	out1 <= '1' WHEN (ins(1) = '1' OR ins(2) = '1' OR ins(3) = '1' OR ins(4) = '1' OR ins(5) = '1' OR ins(6) = '1' OR ins(7) = '1') ELSE
	'0';
END or8_conditional;

ARCHITECTURE or8_selected OF or8 IS
BEGIN
	WITH ins SELECT
		out1 <=
			'0' WHEN "00000000",
			'1' WHEN OTHERS;
END or8_selected;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		\item 
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY mux8to1 IS
	PORT(
		inputs	:	IN	STD_LOGIC_VECTOR(7 DOWNTO 0);		
		sel		:	IN	STD_LOGIC_VECTOR(2 DOWNTO 0);
		output	:	OUT	STD_LOGIC);
END mux8to1;

ARCHITECTURE mux8to1_conditional OF mux8to1 IS
BEGIN
	output <=
		inputs(0) WHEN (sel = "000") ELSE
		inputs(1) WHEN (sel = "001") ELSE
		inputs(2) WHEN (sel = "010") ELSE
		inputs(3) WHEN (sel = "011") ELSE
		inputs(4) WHEN (sel = "100") ELSE
		inputs(5) WHEN (sel = "101") ELSE
		inputs(6) WHEN (sel = "110") ELSE
		inputs(7) WHEN (sel = "111") ELSE
		'0';
END mux8to1_conditional;

ARCHITECTURE mux8to1_selected OF mu8to1 IS
BEGIN
	WITH sel SELECT
		output <=
			inputs(0) WHEN "000",
			inputs(1) WHEN "001",
			inputs(2) WHEN "010",
			inputs(3) WHEN "011",
			inputs(4) WHEN "100",
			inputs(5) WHEN "101",
			inputs(6) WHEN "110",
			inputs(7) WHEN "111",
			'0' WHEN OTHERS;
END mux8to1_selected;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		\item
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY dec3to8_ActiveHigh IS
	PORT (
		inputs	:	IN	STD_LOGIC_VECTOR(2 DOWNTO 0);
		outputs	:	OUT	STD_LOGIC_VECTOR(0 TO 7));
END dec3to8_ActiveHigh;

ARCHITECTURE dec3to8_ActiveHigh_conditional OF dec3to8_ActiveHigh IS
BEGIN
	outputs <=
		"10000000" WHEN (inputs = "000") ELSE
		"01000000" WHEN (inputs = "001") ELSE
		"00100000" WHEN (inputs = "010") ELSE
		"00010000" WHEN (inputs = "011") ELSE
		"00001000" WHEN (inputs = "100") ELSE
		"00000100" WHEN (inputs = "101") ELSE
		"00000010" WHEN (inputs = "110") ELSE
		"00000001" WHEN (inputs = "111") ELSE
		"00000000";
END dec3to8_ActiveHigh_conditional;

ARCHITECTURE dec3to8_ActiveHigh_selected OF dec3to8_ActiveHigh IS
BEGIN
	WITH inputs SELECT
		outputs <=
			"10000000" WHEN "000",
			"01000000" WHEN "001",
			"00100000" WHEN "010",
			"00010000" WHEN "011",
			"00001000" WHEN "100",
			"00000100" WHEN "101",
			"00000010" WHEN "110",
			"00000001" WHEN "111",
			"00000000" WHEN OTHERS;
END dec3to8_ActiveHigh_selected;
		\end{lstlisting}
	\end{minipage}

	\begin{minipage}{1\linewidth}
		\item 
		\begin{lstlisting}
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;

ENTITY dec3to8_ActiveLow IS
	PORT (
		inputs	:	IN	STD_LOGIC_VECTOR(2 DOWNTO 0);
		outputs	:	OUT	STD_LOGIC_VECTOR(0 TO 7));
END dec3to8_ActiveLow;

ARCHITECTURE dec3to8_ActiveLow_conditional OF dec3to8_ActiveLow IS
BEGIN
	outputs <=
		"01111111" WHEN (inputs = "000") ELSE
		"10111111" WHEN (inputs = "001") ELSE
		"11011111" WHEN (inputs = "010") ELSE
		"11101111" WHEN (inputs = "011") ELSE
		"11110111" WHEN (inputs = "100") ELSE
		"11111011" WHEN (inputs = "101") ELSE
		"11111101" WHEN (inputs = "110") ELSE
		"11111110" WHEN (inputs = "111") ELSE
		"11111111";
END dec3to8_ActiveLow_conditional;

ARCHITECTURE dec3to8_ActiveLow_selected OF dec3to8_ActiveLow IS
BEGIN
	WITH inputs SELECT
		outputs <=
			"01111111" WHEN "000",
			"10111111" WHEN "001",
			"11011111" WHEN "010",
			"11101111" WHEN "011",
			"11110111" WHEN "100",
			"11111011" WHEN "101",
			"11111101" WHEN "110",
			"11111110" WHEN "111",
			"11111111" WHEN OTHERS;
END dec3to8_ActiveLow_selected;
		\end{lstlisting}
	\end{minipage}

\end{enumerate}
\resumetocwriting